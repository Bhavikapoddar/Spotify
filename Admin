// Inside AdminController.cs

public ActionResult AdminPanel()
{
    // Get all routes first. This ensures all routes will be on the graph.
    var allRoutes = db.SearchRequest.ToList();

    // Get flight counts for each route that has at least one flight.
    var flightCounts = db.Flight
        .GroupBy(f => f.RouteId)
        .Select(g => new
        {
            RouteId = g.Key,
            FlightCount = g.Count()
        })
        .ToList();

    // Perform a LEFT JOIN to combine all routes with the flight counts.
    var flightStatistics = (from route in allRoutes
                            join count in flightCounts on route.RouteId equals count.RouteId into flightGroup
                            from flightCount in flightGroup.DefaultIfEmpty()
                            select new FlightStatisticViewModel
                            {
                                RouteName = route.FromLocation + " to " + route.Tolocation,
                                // If flightCount is null (because of the left join), the count is 0.
                                FlightCount = flightCount != null ? flightCount.FlightCount : 0
                            }).ToList();

    // Pass the data to the view
    ViewBag.FlightStatistics = flightStatistics;

    // Also passing the other ViewBag data you were using
    ViewBag.Flights = db.Flight.ToList();
    ViewBag.Routes = allRoutes;

    return View();
}
